"use strict";(self.webpackChunkyuewu_dev=self.webpackChunkyuewu_dev||[]).push([[9497],{81959:(k,I,a)=>{a.r(I),a.d(I,{default:()=>me});var e=a(53547),s=a(22551),f=a(22072),z=a(69554),v=a(88767),b=a(64593),O=a(14087),F=a(185),x=a(53979),P=a(49066),y=a(29728),u=a(41580),M=a(11047),q=a(85018),_=a(45697),t=a.n(_),Z=a(75515),C=a(11276),m=a(67819);const U=({errors:r,onChange:d,values:c})=>{const{formatMessage:i}=(0,f.Z)();return e.createElement(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(M.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(Z.Z,{variant:"delta",as:"h2"},i({id:"global.profile",defaultMessage:"Profile"})),e.createElement(C.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(s.GenericInput,{intlLabel:{id:"Auth.form.firstname.label",defaultMessage:"First name"},error:r.firstname,onChange:d,value:c.firstname,type:"text",name:"firstname",required:!0})),e.createElement(m.P,{s:12,col:6},e.createElement(s.GenericInput,{intlLabel:{id:"Auth.form.lastname.label",defaultMessage:"Last name"},error:r.lastname,onChange:d,value:c.lastname,type:"text",name:"lastname"})),e.createElement(m.P,{s:12,col:6},e.createElement(s.GenericInput,{intlLabel:{id:"Auth.form.email.label",defaultMessage:"Email"},error:r.email,onChange:d,value:c.email,type:"email",name:"email",required:!0})),e.createElement(m.P,{s:12,col:6},e.createElement(s.GenericInput,{intlLabel:{id:"Auth.form.username.label",defaultMessage:"Username"},error:r.username,onChange:d,value:c.username,type:"text",name:"username"})))))};U.propTypes={errors:t().shape({firstname:t().string,lastname:t().string,username:t().string,email:t().string}),onChange:t().func,values:t().shape({firstname:t().string,lastname:t().string,username:t().string,email:t().string})},U.defaultProps={errors:{},onChange(){},values:{firstname:"",lastname:"",username:"",email:""}};const ee=U;var Q=a(40619),W=a(82562),ae=a(11700),te=a.n(ae);const N=({onChange:r,values:d,localeNames:c,allApplicationThemes:i})=>{const{formatMessage:n}=(0,f.Z)(),L=Object.keys(i).filter(o=>i[o]);return e.createElement(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(M.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(M.k,{direction:"column",alignItems:"stretch",gap:1},e.createElement(Z.Z,{variant:"delta",as:"h2"},n({id:"Settings.profile.form.section.experience.title",defaultMessage:"Experience"})),e.createElement(Z.Z,null,n({id:"Settings.profile.form.section.experience.interfaceLanguageHelp",defaultMessage:"Preference changes will apply only to you. More information is available {here}."},{here:e.createElement(u.x,{as:"a",color:"primary600",target:"_blank",rel:"noopener noreferrer",href:"https://docs.strapi.io/developer-docs/latest/development/admin-customization.html#locales"},n({id:"Settings.profile.form.section.experience.here",defaultMessage:"here"}))}))),e.createElement(C.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(Q.P,{label:n({id:"Settings.profile.form.section.experience.interfaceLanguage",defaultMessage:"Interface language"}),placeholder:n({id:"global.select",defaultMessage:"Select"}),hint:n({id:"Settings.profile.form.section.experience.interfaceLanguage.hint",defaultMessage:"This will only display your own interface in the chosen language."}),onClear:()=>{r({target:{name:"preferedLanguage",value:null}})},clearLabel:n({id:"Settings.profile.form.section.experience.clear.select",defaultMessage:"Clear the interface language selected"}),value:d.preferedLanguage,onChange:o=>{r({target:{name:"preferedLanguage",value:o}})}},Object.entries(c).map(([o,T])=>e.createElement(W.W,{value:o,key:o},T)))),e.createElement(m.P,{s:12,col:6},e.createElement(Q.P,{label:n({id:"Settings.profile.form.section.experience.mode.label",defaultMessage:"Interface mode"}),placeholder:n({id:"components.Select.placeholder",defaultMessage:"Select"}),hint:n({id:"Settings.profile.form.section.experience.mode.hint",defaultMessage:"Displays your interface in the chosen mode."}),value:d.currentTheme,onChange:o=>{r({target:{name:"currentTheme",value:o}})}},L.map(o=>e.createElement(W.W,{value:o,key:o},n({id:"Settings.profile.form.section.experience.mode.option-label",defaultMessage:"{name} mode"},{name:n({id:o,defaultMessage:te()(o)})}))))))))};N.propTypes={allApplicationThemes:t().object,onChange:t().func,values:t().shape({preferedLanguage:t().string,currentTheme:t().string}),localeNames:t().object},N.defaultProps={allApplicationThemes:{},onChange(){},values:{preferedLanguage:null,currentTheme:""},localeNames:{}};const se=N;var $=a(54863),X=a(16364),re=a(25752),B=a(8934),D=a(94123);const Y=(0,$.default)(X.o)`
  ::-ms-reveal {
    display: none;
  }
`,G=(0,$.default)(re.E)`
  svg {
    height: ${(0,s.pxToRem)(16)};
    width: ${(0,s.pxToRem)(16)};
    path {
      fill: ${({theme:r})=>r.colors.neutral600};
    }
  }
`,H=({errors:r,onChange:d,values:c})=>{const{formatMessage:i}=(0,f.Z)(),[n,L]=(0,e.useState)(!1),[o,T]=(0,e.useState)(!1),[A,j]=(0,e.useState)(!1);return e.createElement(u.x,{background:"neutral0",hasRadius:!0,shadow:"filterShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7},e.createElement(M.k,{direction:"column",alignItems:"stretch",gap:4},e.createElement(Z.Z,{variant:"delta",as:"h2"},i({id:"global.change-password",defaultMessage:"Change password"})),e.createElement(C.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(X.o,{error:r.currentPassword?i({id:r.currentPassword,defaultMessage:r.currentPassword}):"",onChange:d,value:c.currentPassword,label:i({id:"Auth.form.currentPassword.label",defaultMessage:"Current Password"}),name:"currentPassword",type:n?"text":"password",endAction:e.createElement(G,{onClick:h=>{h.stopPropagation(),L(w=>!w)},label:i(n?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},n?e.createElement(B.Z,null):e.createElement(D.Z,null))}))),e.createElement(C.r,{gap:5},e.createElement(m.P,{s:12,col:6},e.createElement(Y,{error:r.password?i({id:r.password,defaultMessage:r.password}):"",onChange:d,value:c.password,label:i({id:"global.password",defaultMessage:"Password"}),name:"password",type:o?"text":"password",autoComplete:"new-password",endAction:e.createElement(G,{onClick:h=>{h.stopPropagation(),T(w=>!w)},label:i(o?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},o?e.createElement(B.Z,null):e.createElement(D.Z,null))})),e.createElement(m.P,{s:12,col:6},e.createElement(Y,{error:r.confirmPassword?i({id:r.confirmPassword,defaultMessage:r.confirmPassword}):"",onChange:d,value:c.confirmPassword,label:i({id:"Auth.form.confirmPassword.label",defaultMessage:"Password confirmation"}),name:"confirmPassword",type:A?"text":"password",autoComplete:"new-password",endAction:e.createElement(G,{onClick:h=>{h.stopPropagation(),j(w=>!w)},label:i(A?{id:"Auth.form.password.show-password",defaultMessage:"Show password"}:{id:"Auth.form.password.hide-password",defaultMessage:"Hide password"})},A?e.createElement(B.Z,null):e.createElement(D.Z,null))})))))};H.propTypes={errors:t().shape({currentPassword:t().string,password:t().string,confirmPassword:t().string}),onChange:t().func,values:t().shape({currentPassword:t().string,password:t().string,confirmPassword:t().string})},H.defaultProps={errors:{},onChange(){},values:{currentPassword:"",password:"",confirmPassword:""}};const ne=H;var oe=a(50592),le=a(95428),ie=a(87561),de=a(17405);const ce=ie.Ry().shape(de.Rw);var V=a(19631);const me=()=>{const{changeLocale:r,localeNames:d}=(0,oe.Z)(),{setUserDisplayName:c}=(0,s.useAppInfo)(),i=(0,v.useQueryClient)(),{formatMessage:n}=(0,f.Z)(),{trackUsage:L}=(0,s.useTracking)(),o=(0,s.useNotification)(),{lockApp:T,unlockApp:A}=(0,s.useOverlayBlocker)(),{notifyStatus:j}=(0,O.G)(),{currentTheme:h,themes:w,onChangeTheme:ue}=(0,le.M1)(),{get:J,put:pe}=(0,s.useFetchClient)();(0,s.useFocusWhenNavigate)();const{isLoading:ge,data:R}=(0,v.useQuery)("user",async()=>{const{data:l}=await J("/admin/users/me");return l.data},{onSuccess(){j(n({id:"Settings.profile.form.notify.data.loaded",defaultMessage:"Your profile data has been loaded"}))},onError(){o({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}}),{isLoading:fe,data:he}=(0,v.useQuery)(["providers","isSSOLocked"],async()=>{if(window.strapi.isEE){const{data:{data:l}}=await J("/admin/providers/isSSOLocked");return l}return{isSSOLocked:!1}},{onError(){o({type:"warning",message:{id:"Settings.permissions.users.sso.provider.error"}})}}),we=ge||fe,K=(0,v.useMutation)(async l=>{const{confirmPassword:p,currentTheme:g,...E}=l,{data:S}=await pe("/admin/users/me",E);return{...S.data,currentTheme:l.currentTheme}},{async onSuccess(l){await i.invalidateQueries("user");const{email:p,firstname:g,lastname:E,username:S,preferedLanguage:Ie}=l;s.auth.setUserInfo({email:p,firstname:g,lastname:E,username:S,preferedLanguage:Ie});const xe=l.username||(0,V.Pp)(l.firstname,l.lastname);c(xe),r(l.preferedLanguage),ue(l.currentTheme),L("didChangeMode",{newMode:l.currentTheme}),o({type:"success",message:{id:"notification.success.saved",defaultMessage:"Saved"}})},onSettled(){A()},refetchActive:!0}),{isLoading:Ee}=K,ve=async(l,{setErrors:p})=>{T();const g=l.username||null;K.mutate({...l,username:g},{onError(E){const S=E?.response?.data;return S?.data?p(S.data):o({type:"warning",message:{id:"notification.error",defaultMessage:"An error occured"}})}})};if(we)return e.createElement(F.o,{"aria-busy":"true"},e.createElement(b.q,{title:n({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(x.T,{title:n({id:"Settings.profile.form.section.profile.page.title",defaultMessage:"Profile page"})}),e.createElement(P.D,null,e.createElement(s.LoadingIndicatorPage,null)));const Pe=he?.isSSOLocked,{email:ye,firstname:Se,lastname:Me,username:Le,preferedLanguage:Te}=R,Ae={email:ye,firstname:Se,lastname:Me,username:Le,preferedLanguage:Te,currentTheme:h};return e.createElement(F.o,{"aria-busy":Ee},e.createElement(b.q,{title:n({id:"Settings.profile.form.section.helmet.title",defaultMessage:"User profile"})}),e.createElement(z.Formik,{onSubmit:ve,initialValues:Ae,validateOnChange:!1,validationSchema:ce,enableReinitialize:!0},({errors:l,values:p,handleChange:g,isSubmitting:E})=>e.createElement(s.Form,null,e.createElement(x.T,{title:R.username||(0,V.Pp)(R.firstname,R.lastname),primaryAction:e.createElement(y.z,{startIcon:e.createElement(q.Z,null),loading:E,type:"submit"},n({id:"global.save",defaultMessage:"Save"}))}),e.createElement(u.x,{paddingBottom:10},e.createElement(P.D,null,e.createElement(M.k,{direction:"column",alignItems:"stretch",gap:6},e.createElement(ee,{errors:l,onChange:g,values:p}),!Pe&&e.createElement(ne,{errors:l,onChange:g,values:p}),e.createElement(se,{allApplicationThemes:w,onChange:g,values:p,localeNames:d})))))))}},17405:(k,I,a)=>{a.d(I,{YM:()=>x,Rw:()=>v});var e=a(87561),s=a(22551);const f={firstname:e.Z_().trim().required(s.translatedErrors.required),lastname:e.Z_(),email:e.Z_().email(s.translatedErrors.email).lowercase().required(s.translatedErrors.required),username:e.Z_().nullable(),password:e.Z_().min(8,s.translatedErrors.minLength).matches(/[a-z]/,"components.Input.error.contain.lowercase").matches(/[A-Z]/,"components.Input.error.contain.uppercase").matches(/\d/,"components.Input.error.contain.number"),confirmPassword:e.Z_().min(8,s.translatedErrors.minLength).oneOf([e.iH("password"),null],"components.Input.error.password.noMatch").when("password",(P,y)=>P?y.required(s.translatedErrors.required):y)},v={...f,currentPassword:e.Z_().when(["password","confirmPassword"],(P,y,u)=>P||y?u.required(s.translatedErrors.required):u),preferedLanguage:e.Z_().nullable()},O={roles:e.IX().min(1,s.translatedErrors.required).required(s.translatedErrors.required)},x=e.Ry().shape({...f,isActive:e.Xg(),...O})}}]);
